<!DOCTYPE html>
<html>
<head>
    <title>Open Tab Blocker</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>

    <header>
        <div class="tabs">
            <div class="tab active" data-tab="manage" title="Buckets">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="1" width="6" height="6" rx="1"/>
                    <rect x="9" y="1" width="6" height="6" rx="1"/>
                    <rect x="1" y="9" width="6" height="6" rx="1"/>
                    <rect x="9" y="9" width="6" height="6" rx="1"/>
                </svg>
            </div>
            <div class="tab" data-tab="add" title="Add Bucket">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round">
                    <line x1="8" y1="3" x2="8" y2="13"/>
                    <line x1="3" y1="8" x2="13" y2="8"/>
                </svg>
            </div>
            <div class="tab" data-tab="settings" title="Settings">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round">
                    <path d="M6.9 3.3L7.0 1.6 9.0 1.6 9.1 3.3 10.5 3.9 11.8 2.7 13.3 4.2 12.1 5.5 12.7 6.9 14.4 7.0 14.4 9.0 12.7 9.1 12.1 10.5 13.3 11.8 11.8 13.3 10.5 12.1 9.1 12.7 9.0 14.4 7.0 14.4 6.9 12.7 5.5 12.1 4.2 13.3 2.7 11.8 3.9 10.5 3.3 9.1 1.6 9.0 1.6 7.0 3.3 6.9 3.9 5.5 2.7 4.2 4.2 2.7 5.5 3.9Z"/>
                    <circle cx="8" cy="8" r="2.5"/>
                </svg>
            </div>
            <div class="tab" data-tab="history" id="historyTab" title="History" style="display: none;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="8" cy="8" r="6.5"/>
                    <polyline points="8,4 8,8 11,10"/>
                </svg>
            </div>
        </div>

        <img src="icons/logo.png" alt="Open Tab Blocker">
    </header>

    <div id="manageView" class="tab-section">
        <div id="bucketList" class="bucket-list">
            <!-- Buckets will be inserted here dynamically -->
        </div>
    </div>

    <div id="settingsView" class="tab-section" style="display: none;">
        <div class="settings-section">
            <div class="setting-item">
                <div class="setting-info">
                    <h3>Friction Mode</h3>
                    <p class="setting-description">Require typing a challenge sentence before disabling a bucket, deleting a bucket, or turning off Friction Mode.</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="frictionModeToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item" style="margin-top: 10px;">
                <div class="setting-info">
                    <h3>Record Unlocks</h3>
                    <p class="setting-description">Log every time you disable a bucket so you can review your weak moments in the History tab. Records are kept for 7 days.</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="recordUnlocksToggle">
                    <span class="slider"></span>
                </label>
            </div>
            <div class="setting-item" style="margin-top: 10px;">
                <div class="setting-info">
                    <h3>Track Block Attempts</h3>
                    <p class="setting-description">Count every time you hit a blocked site. Per-bucket counts are shown in the History tab. Data kept for 7 days.</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="trackBlockCountsToggle">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>

    <div id="historyView" class="tab-section" style="display: none;">
        <div id="blockCountsSummary" style="display: none;"></div>
        <div id="unlockHistorySection">
            <div class="history-header">
                <h3>Unlock History</h3>
                <button id="clearHistory" class="secondary">Clear History</button>
            </div>
            <div id="historyEntries"></div>
        </div>
    </div>

    <div id="frictionModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 class="modal-title">Friction Mode Active</h3>
            <p class="modal-instruction">Type the following sentence to continue:</p>
            <p class="friction-sentence" id="frictionSentence"></p>
            <input type="text" id="frictionInput" class="friction-input" placeholder="Type the sentence above..." autocomplete="off">
            <div class="modal-buttons">
                <button id="frictionCancel" class="secondary">Cancel</button>
                <button id="frictionConfirm" class="primary" disabled>Confirm</button>
            </div>
        </div>
    </div>

    <div id="addForm" class="tab-section form-section" style="display: none;">
        <div id="bucketForm">
            <h3 id="formTitle">Add New Bucket</h3>
            <div class="form-group">
                <label for="bucketName">Bucket Name:</label>
                <input type="text" id="bucketName" placeholder="e.g., Social Media, Gaming, etc.">
            </div>

            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="alwaysBlock">
                    Always Block
                </label>
            </div>

            <div id="timeSettings" class="form-group">
                <label>Blocking Periods:</label>
                <div class="time-period">
                    <div class="time-period-inputs">
                        <input type="time" id="startTime"> to
                        <input type="time" id="endTime">
                        <span class="time-control-icon add-time" title="Add second time period">+</span>
                    </div>
                    <div class="time-period-inputs second-period" style="display: none;">
                        <input type="time" id="startTime2"> to
                        <input type="time" id="endTime2">
                        <span class="time-control-icon remove-time" title="Remove second time period">&#128473;</span>
                    </div>
                </div>
                <div id="daysSelection">
                    <label><input type="checkbox" class="day-checkbox" value="0"> Sun</label>
                    <label><input type="checkbox" class="day-checkbox" value="1"> Mon</label>
                    <label><input type="checkbox" class="day-checkbox" value="2"> Tue</label>
                    <label><input type="checkbox" class="day-checkbox" value="3"> Wed</label>
                    <label><input type="checkbox" class="day-checkbox" value="4"> Thu</label>
                    <label><input type="checkbox" class="day-checkbox" value="5"> Fri</label>
                    <label><input type="checkbox" class="day-checkbox" value="6"> Sat</label>
                </div>
                <p class="helper-text">Leave all days unchecked to block every day</p>
            </div>

            <div class="button-group">
                <button id="saveBucket" class="primary">Create Bucket</button>
                <button id="cancelEdit" class="secondary" style="display: none;">Cancel</button>
            </div>
        </div>
    </div>

    <script src="popup.js"></script>
</body>
</html>
